{
  "name": "microsoft-defender-for-iot",
  "label": "Microsoft Defender for IoT",
  "version": "1.0.0",
  "description": "Microsoft Defender for IoT consolidates real-time asset discovery, vulnerability management, and cyberthreat protection for your Internet of Things (IoT) and industrial infrastructure, such as industrial control systems (ICS) and operational technology (OT). This connector facilitates automated interactions, with a Microsoft Defender for IoT server using FortiSOARâ„¢ playbooks to effectively view, analyze, and respond to alerts generated by Defender for IoT ",
  "publisher": "Fortinet",
  "cs_approved": false,
  "cs_compatible": true,
  "category": "OT & IoT Security ",
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "help_online": "https://github.com/fortinet-fortisoar/connector-microsoft-defender-for-iot/blob/release/1.0.0/docs/MicrosoftDefenderForIOTDoc.md",
  "configuration": {
    "fields": [
      {
        "title": "Server URL",
        "type": "text",
        "name": "server_url",
        "required": true,
        "editable": true,
        "visible": true,
        "value": "",
        "tooltip": "IP address or hostname of the Microsoft Defender for IoT server to which you will connect and perform automated operations.",
        "description": "IP address or hostname of the Microsoft Defender for IoT server to which you will connect and perform automated operations."
      },
      {
        "title": "Access Token",
        "type": "password",
        "name": "api_key",
        "required": true,
        "editable": true,
        "visible": true,
        "tooltip": "Specify the access token for authentication with Microsoft Defender for IoT.",
        "description": "Specify the access token for authentication with Microsoft Defender for IoT."
      },
      {
        "title": "Verify SSL",
        "name": "verify_ssl",
        "type": "checkbox",
        "required": false,
        "editable": true,
        "visible": true,
        "value": true,
        "description": "(Optional) Specifies whether the SSL certificate for the server is to be verified or not.By default, this option is set as True."
      }
    ]
  },
  "operations": [
    {
      "operation": "list_alerts",
      "title": "Get Alert List",
      "description": "Retrieves a list of alerts that Defender for IoT sensor has detected based on input parameters specified.",
      "category": "investigation",
      "annotation": "list_alerts",
      "enabled": true,
      "output_schema": [
        {
          "engine": "",
          "severity": "",
          "title": "",
          "additionalinformation": {
            "information": [],
            "description": ""
          },
          "sourceDevice": "",
          "destinationDevice": "",
          "time": "",
          "message": "",
          "id": ""
        }
      ],
      "parameters": [
        {
          "title": "State",
          "name": "state",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "select",
          "options": [
            "Handled",
            "Unhandled"
          ],
          "tooltip": "Select state of alerts which is to be retrieved from Defender for IoT.",
          "description": "(Optional) Select state of alerts which is to be retrieved from Defender for IoT.\nYou can choose from Handled, Unhandled."
        },
        {
          "title": "Type",
          "name": "type",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "select",
          "options": [
            "Unexpected New Devices",
            "Disconnections"
          ],
          "tooltip": "Select type of alerts which is to be retrieved from Defender for IoT.",
          "description": "(Optional) Select type of alerts which is to be retrieved from Defender for IoT.\nYou can choose from Unexpected New Devices, Disconnections."
        },
        {
          "title": "Created After",
          "name": "fromTime",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "datetime",
          "tooltip": "Specify the datetime to retrieve alerts created after specified time from Defender for IoT.",
          "description": "(Optional) Specify the datetime to retrieve alerts created after specified time from Defender for IoT."
        },
        {
          "title": "Created Before",
          "name": "toTime",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "datetime",
          "tooltip": "Specify the datetime to retrieve alerts created before specified time from Defender for IoT.",
          "description": "(Optional) Specify the datetime to retrieve alerts created before specified time from Defender for IoT."
        }
      ]
    },
    {
      "operation": "list_timeline_events",
      "title": "Get Timeline Events",
      "description": "Retrieves a list of events reported to the event timeline.",
      "category": "investigation",
      "annotation": "list_timeline_events",
      "enabled": true,
      "output_schema": [
        {
          "severity": "",
          "title": "",
          "timestamp": "",
          "content": "",
          "owner": "",
          "type": ""
        }
      ],
      "parameters": [
        {
          "title": "Type",
          "name": "type",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "select",
          "options": [
            "Address Update",
            "Alert Detected",
            "Alert Updated",
            "Back to Normal",
            "Cleartext Authentication",
            "Common ASCII Message Protocol Memory Write Operation",
            "Configuration Of Cleartext Password",
            "Controller Program Delete",
            "Controller Program Reset",
            "Controller Reset",
            "Controller Start",
            "Controller Stop",
            "Data Intelligence Package Installation Failure",
            "Data Intelligence Package Uploaded",
            "Database Structure Manipulation",
            "DeltaV Install Script",
            "Device Connection Detected",
            "Device Deleted",
            "Device Detected",
            "Device Updated",
            "Event Detected and Muted",
            "Exclusion Rule Created",
            "Exclusion Rule Removed",
            "Exclusion Rule Updated",
            "FTP Authentication Failure",
            "File Transfer Detected",
            "Firmware Update",
            "HTTP Basic Authentication",
            "Inactive Devices Scheduled for deletion",
            "Internet Access",
            "MMS Memory Block Operation",
            "MMS Program Operation",
            "Notification was resolved manually",
            "OPC AE Event",
            "OPC AE Event Condition Management Operation",
            "OPC AE Event Subscription",
            "OPC Data Access Group Management Operation",
            "OPC Data Access IO Subscription Management Operation",
            "OPC Data Access Item Management Operation",
            "PLC Change access level",
            "PLC Change access level failed",
            "PLC Configuration Read",
            "PLC Configuration Write",
            "PLC Firmware Changed",
            "PLC Mode Change",
            "PLC Module Change",
            "PLC Operating Mode Change Detected",
            "PLC Password Change",
            "PLC Program Update",
            "PLC Program Upload",
            "PLC Programming",
            "PLC Programming Mode Set",
            "PLC Reset",
            "PLC Start",
            "Profinet SET operation",
            "Remote Access Connection Established",
            "Remote Process Execution",
            "Report Created",
            "SCL Uploaded",
            "SNMP Trap detected",
            "Scan Device Detected",
            "Siemens S7 Authentication",
            "Siemens S7 Memory Block Operation",
            "Syslog Message",
            "Telnet Authentication Failure",
            "User Defined Event",
            "User Defined Rule Created",
            "User Defined Rule Deleted",
            "User Defined Rule Edited",
            "User Defined Rule Operation",
            "User Login Attempt",
            "User Operation",
            "Wonderware session initialized"
          ],
          "tooltip": "Select type of alerts which is to be retrieved from Defender for IoT.",
          "description": "(Optional) Select type of alerts which is to be retrieved from Defender for IoT.\nYou can choose from Address Update, Alert Detected, Alert Updated, Back to Normal, Cleartext Authentication, Common ASCII Message Protocol Memory Write Operation, Configuration Of Cleartext Password, Controller Program Delete, Controller Program Reset, Controller Reset, Controller Start, Controller Stop, Data Intelligence Package Installation Failure, Data Intelligence Package Uploaded, Database Structure Manipulation, DeltaV Install Script, Device Connection Detected, Device Deleted, Device Detected, Device Updated, Event Detected and Muted, Exclusion Rule Created, Exclusion Rule Removed, Exclusion Rule Updated, FTP Authentication Failure, File Transfer Detected, Firmware Update, HTTP Basic Authentication, Inactive Devices Scheduled for deletion, Internet Access, MMS Memory Block Operation, MMS Program Operation, Notification was resolved manually, OPC AE Event, OPC AE Event Condition Management Operation, OPC AE Event Subscription, OPC Data Access Group Management Operation, OPC Data Access IO Subscription Management Operation, OPC Data Access Item Management Operation, PLC Change access level, PLC Change access level failed, PLC Configuration Read, PLC Configuration Write, PLC Firmware Changed, PLC Mode Change, PLC Module Change, PLC Operating Mode Change Detected, PLC Password Change, PLC Program Update, PLC Program Upload, PLC Programming, PLC Programming Mode Set, PLC Reset, PLC Start, Profinet SET operation, Remote Access Connection Established, Remote Process Execution, Report Created, SCL Uploaded, SNMP Trap detected, Scan Device Detected, Siemens S7 Authentication, Siemens S7 Memory Block Operation, Syslog Message, Telnet Authentication Failure, User Defined Event, User Defined Rule Created, User Defined Rule Deleted, User Defined Rule Edited, User Defined Rule Operation, User Login Attempt, User Operation, Wonderware session initialized."
        },
        {
          "title": "Reported in Last x Minutes",
          "name": "minutesTimeFrame",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "integer",
          "tooltip": "Specify the time duration (in minutes) to retrieve events reported within a specified timeframe, calculated backward from the current time.",
          "description": "(Optional) Specify the time duration (in minutes) to retrieve events reported within a specified timeframe, calculated backward from the current time."
        }
      ]
    },
    {
      "operation": "list_devices",
      "title": "Get Device List",
      "description": "Retrieves a list of devices detected by this sensor based on input parameter specified.",
      "category": "investigation",
      "annotation": "list_devices",
      "enabled": true,
      "output_schema": {},
      "parameters": [
        {
          "title": "Authorized",
          "name": "authorized",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "select",
          "tooltip": "Specify whether you want to retrieve authorized or unauthorized devices which is detected by this sensor.",
          "description": "(Optional) Specify whether you want to retrieve authorized or unauthorized devices which is detected by this sensor.\nYou can choose from True, False.",
          "options": [
            "True",
            "False"
          ]
        }
      ]
    },
    {
      "operation": "list_device_cves",
      "title": "Get Device CVEs List",
      "description": "Retrieves a list of all known CVEs discovered on devices in the network, sorted by descending CVE score.",
      "category": "investigation",
      "annotation": "list_device_cves",
      "enabled": true,
      "output_schema": [
        {
          "cveId": "",
          "score": "",
          "ipAddress": "",
          "attackVector": "",
          "description": ""
        }
      ],
      "parameters": [
        {
          "title": "IP Address",
          "name": "ipAddress",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "text",
          "tooltip": "Specify the IP Address to get CVEs for that device IP address from Defender for IoT.",
          "description": "(Optional) Specify the IP Address to get CVEs for that device IP address from Defender for IoT."
        },
        {
          "title": "Size",
          "name": "top",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "integer",
          "value": 100,
          "tooltip": "Specify the how many top-scored CVEs to get for each device IP address from Defender for IoT.",
          "description": "(Optional) Specify the how many top-scored CVEs to get for each device IP address from Defender for IoT. By default it is set to 100."
        }
      ]
    },
    {
      "operation": "get_device_vulnerability_report",
      "title": "Get Device Vulnerability Information",
      "description": "Retrieves  a general vulnerability assessment report. This assessment provides insight into your system's security level.",
      "category": "investigation",
      "annotation": "get_device_vulnerability_report",
      "enabled": true,
      "output_schema": [
        {
          "name": "",
          "ipAddresses": [],
          "securityScore": "",
          "vendor": "",
          "firmwareVersion": "",
          "model": "",
          "operatingSystem": {
            "name": "",
            "type": "",
            "version": "",
            "latestVersion": ""
          },
          "vulnerabilities": {
            "antiViruses": [],
            "plainTextPasswords": [
              {
                "password": "",
                "protocol": "",
                "strength": ""
              }
            ],
            "remoteAccess": [
              {
                "port": "",
                "transport": "",
                "clientSoftware": "",
                "client": ""
              }
            ],
            "isBackupServer": "",
            "openedPorts": [
              {
                "port": "",
                "transport": "",
                "protocol": "",
                "isConflictingWithFirewall": ""
              }
            ],
            "isEngineeringStation": "",
            "isKnownScanner": "",
            "cves": [
              {
                "id": "",
                "score": "",
                "description": ""
              }
            ],
            "isUnauthorized": "",
            "malwareIndicationsDetected": ""
          }
        }
      ],
      "parameters": []
    },
    {
      "operation": "get_vulnerability_assessment_report",
      "title": "Get Security Vulnerabilities",
      "description": "Retrieves general vulnerability assessment report. This assessment provides insight into your system's security level.",
      "category": "investigation",
      "annotation": "get_vulnerability_assessment_report",
      "enabled": true,
      "output_schema": {
        "unauthorizedDevices": [
          {
            "address": "",
            "name": "",
            "firstDetectionTime": "",
            "lastSeen": ""
          }
        ],
        "redundantFirewallRules": [
          {
            "sources": "",
            "destinations": "",
            "ports": ""
          }
        ],
        "connectionsBetweenSubnets": [
          {
            "server": "",
            "client": ""
          }
        ],
        "industrialMalwareIndications": [
          {
            "detectionTime": "",
            "alertMessage": "",
            "description": "",
            "addresses": []
          }
        ],
        "illegalTrafficByFirewallRules": [
          {
            "server": "",
            "port": "",
            "client": "",
            "transport": ""
          }
        ],
        "internetConnections": [
          {
            "internalAddress": "",
            "authorized": "",
            "externalAddresses": []
          }
        ],
        "accessPoints": [
          {
            "macAddress": "",
            "vendor": "",
            "ipAddress": "",
            "name": "",
            "wireless": ""
          }
        ],
        "weakFirewallRules": [
          {
            "sources": "",
            "destinations": "",
            "ports": ""
          }
        ]
      },
      "parameters": []
    },
    {
      "operation": "get_operational_assessment_report",
      "title": "Get Operational Vulnerabilities",
      "description": "Retrieves operational vulnerability assessment report. This assessment provides insight into the operational status of your network. It's based on general network and system information and not on a specific device evaluation.",
      "category": "investigation",
      "annotation": "get_operational_assessment_report",
      "enabled": true,
      "output_schema": {
        "backupServer": [
          {
            "backupMaximalInterval": "",
            "source": "",
            "destination": "",
            "port": "",
            "transport": "",
            "lastSeenBackup": ""
          }
        ],
        "ipNetworks": [
          {
            "addresses": "",
            "network": "",
            "mask": ""
          }
        ],
        "protocolProblems": [
          {
            "protocol": "",
            "addresses": [],
            "alert": "",
            "reportTime": ""
          }
        ],
        "protocolDataVolumes": [
          {
            "protocol": "",
            "volume": ""
          }
        ],
        "disconnections": [
          {
            "assetAddress": "",
            "assetName": "",
            "lastDetectionTime": "",
            "backToNormalTime": ""
          }
        ]
      },
      "parameters": []
    },
    {
      "operation": "get_mitigation_assessment",
      "title": "Get Mitigation Steps",
      "description": "Retrieves a mitigation assessment. This assessment provides recommended steps for mitigating detected vulnerabilities. It's based on general network and system information and not on a specific device evaluation.",
      "category": "investigation",
      "annotation": "get_mitigation_assessment",
      "enabled": true,
      "output_schema": {
        "notifications": [],
        "mitigation": [
          {
            "content": "",
            "details": "",
            "scoreImprovement": ""
          }
        ]
      },
      "parameters": []
    },
    {
      "operation": "list_device_connections",
      "title": "Get Device Connections",
      "description": "Retrieves a list of device connections based on input parameters specified.",
      "category": "investigation",
      "annotation": "list_device_connections",
      "visible": false,
      "enabled": true,
      "output_schema": {},
      "parameters": [
        {
          "title": "Discovered After",
          "name": "discoveredAfter",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "datetime",
          "tooltip": "Specify the datetime to retrieve device connections detected after specified time from Defender for IoT.",
          "description": "(Optional) Specify the datetime to retrieve device connections detected after specified time from Defender for IoT."
        },
        {
          "title": "Discovered Before",
          "name": "discoveredBefore",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "datetime",
          "tooltip": "Specify the datetime to retrieve device connections detected before specified time from Defender for IoT.",
          "description": "(Optional) Specify the datetime to retrieve device connections detected before specified time from Defender for IoT."
        },
        {
          "title": "Active in Last x Minutes",
          "name": "lastActiveInMinutes",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "integer",
          "tooltip": "Specify the time duration (in minutes) to retrieve device connections that were active within a specified timeframe, calculated backward from the current time.",
          "description": "(Optional) Specify the time duration (in minutes) to retrieve device connections that were active within a specified timeframe, calculated backward from the current time."
        }
      ]
    }
  ]
}